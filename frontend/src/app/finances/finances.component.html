@if(isAdmin()){
  <div class="h-full flex flex-col items-center w-full gap-8 p-4 sm:p-8 text-secondary/85">
    <div class="card w-full bg-neutral shadow-xl">
        <div class="card-body gap-0 p-0 px-1">
            <h1 class="card-title self-center font-medium my-8 text-4xl">Escritório</h1>
            <div class="flex flex-row gap-4 pb-1 mx-2 overflow-x-auto">            
                <div class="stats shadow-lg w-full min-w-max">
                  <div class="stat bg-primary text-base-100">
                    <div class="stat-figure">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                          <path d="M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" />
                          <path fill-rule="evenodd" d="M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z" clip-rule="evenodd" />
                          <path d="M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z" />
                      </svg>                      
                    </div>
                    <div class="stat-title text-base-100">Saldo do Escritório</div>
                    @if (valueSum$ | async; as valueSum){
                      <div class="stat-value text-base-100">R$ {{valueSum.net_income}}</div>  
                    } @else {
                      <div class="stat-value text-base-100">R$ 0</div>
                    }
                  </div>   
                </div>
                
                <div class="stats min-w-max w-full shadow-lg">
                  <div class="stat">
                    <div class="stat-figure text-secondary">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                          <path fill-rule="evenodd" d="M15.22 6.268a.75.75 0 0 1 .968-.431l5.942 2.28a.75.75 0 0 1 .431.97l-2.28 5.94a.75.75 0 1 1-1.4-.537l1.63-4.251-1.086.484a11.2 11.2 0 0 0-5.45 5.173.75.75 0 0 1-1.199.19L9 12.312l-6.22 6.22a.75.75 0 0 1-1.06-1.061l6.75-6.75a.75.75 0 0 1 1.06 0l3.606 3.606a12.695 12.695 0 0 1 5.68-4.974l1.086-.483-4.251-1.632a.75.75 0 0 1-.432-.97Z" clip-rule="evenodd" />
                      </svg> 
                    </div>
                    <div class="stat-title">Receitas</div>
                    @if (valueSum$ | async; as valueSum){
                      <div class="stat-value text-success/85">R$ {{valueSum.total_in}}</div>  
                    } @else {
                      <div class="stat-value text-success/85">R$ 0</div>
                    }
                    <div class="stat-desc"></div>
                  </div>
                </div>
                
                <div class="stats min-w-max w-full shadow-lg">
                  <div class="stat border-secondary/50">
                    <div class="stat-figure text-secondary">
                      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                          <path fill-rule="evenodd" d="M1.72 5.47a.75.75 0 0 1 1.06 0L9 11.69l3.756-3.756a.75.75 0 0 1 .985-.066 12.698 12.698 0 0 1 4.575 6.832l.308 1.149 2.277-3.943a.75.75 0 1 1 1.299.75l-3.182 5.51a.75.75 0 0 1-1.025.275l-5.511-3.181a.75.75 0 0 1 .75-1.3l3.943 2.277-.308-1.149a11.194 11.194 0 0 0-3.528-5.617l-3.809 3.81a.75.75 0 0 1-1.06 0L1.72 6.53a.75.75 0 0 1 0-1.061Z" clip-rule="evenodd" />
                      </svg>                        
                    </div>
                    <div class="stat-title">Despesas</div>
                    @if (valueSum$ | async; as valueSum){
                      <div class="stat-value text-error">R$ {{valueSum.total_out}}</div>  
                    } @else {
                      <div class="stat-value text-error">R$ 0</div>
                    }
                    <div class="stat-desc"></div>
                  </div>
                </div>
            </div>
  
            <bills (editBill)="onEditBill($event)"></bills>
        </div>
    </div>
    
    <div class="card w-full bg-neutral shadow-xl">
      <div class="card-body gap-0 p-0 px-3 pb-3">
        <h1 class="card-title self-center font-medium my-8 text-4xl">Consulta de processos</h1>
        <div class="stats self-center w-max shadow">
          <div class="stat bg-primary text-base-100">
            <div class="stat-figure">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                  <path d="M12 7.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" />
                  <path fill-rule="evenodd" d="M1.5 4.875C1.5 3.839 2.34 3 3.375 3h17.25c1.035 0 1.875.84 1.875 1.875v9.75c0 1.036-.84 1.875-1.875 1.875H3.375A1.875 1.875 0 0 1 1.5 14.625v-9.75ZM8.25 9.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM18.75 9a.75.75 0 0 0-.75.75v.008c0 .414.336.75.75.75h.008a.75.75 0 0 0 .75-.75V9.75a.75.75 0 0 0-.75-.75h-.008ZM4.5 9.75A.75.75 0 0 1 5.25 9h.008a.75.75 0 0 1 .75.75v.008a.75.75 0 0 1-.75.75H5.25a.75.75 0 0 1-.75-.75V9.75Z" clip-rule="evenodd" />
                  <path d="M2.25 18a.75.75 0 0 0 0 1.5c5.4 0 10.63.722 15.6 2.075 1.19.324 2.4-.558 2.4-1.82V18.75a.75.75 0 0 0-.75-.75H2.25Z" />
              </svg>                      
            </div>
            <div class="stat-title text-base-100">Saldo do Escavador</div>
            @if (escavadorBalance$ | async; as escavadorBalance){
              <div class="stat-value text-base-100">{{escavadorBalance.saldo_descricao}}</div>  
            } @else {
              <div class="stat-value text-base-100">R$ 0</div>
            }
          </div>   
        </div>
      </div>
    </div>
  </div>
  
  <button class="btn btn-primary fixed z-30 top-2 right-2" (click)="openBillForm()">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
        <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m3.75 9v6m3-3H9m1.5-12H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
    </svg>          
  </button>
  
  <dialog [ngClass]="billForm ? 'modal-open' : ''" class="modal z-50">
    <div class="modal-box flex flex-col overflow-y-clip max-w-3xl p-1 bg-neutral">
        <form method="dialog">
            <button (click)="closeBillForm()" (click)="resetForm(billModalForm)" class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">✕</button>
        </form>
        <h2 class="card-title text-center self-center mb-4 px-8 mt-6">Cadastro de despesas e receitas</h2>
        <form #billModalForm="ngForm" (ngSubmit)="addBill(billModalForm)" class="flex overflow-y-scroll w-full mb-4 p-1 max-h-max static flex-col gap-2">
          <div class="flex flex-col min-[380px]:flex-row gap-2">
            <label for="typeSelect" class="form-control w-full">
              <div class="label">
                <span class="label-text text-secondary/60">Tipo *</span>
              </div>
              <select #typeSelect="ngModel" required id="typeSelect" name="typeSelect" [(ngModel)]="type" class="select w-full">
                  <option disabled value="null">Escolha um tipo</option>
                  <option value="IN">Receita</option>
                  <option value="OUT">Despesa</option>
              </select>
              @if(typeSelect.invalid && typeSelect.touched){
                <p class="text-error">O tipo é obrigatório!</p>
              }
            </label>
  
            <label for="statusSelect" class="form-control w-full">
              <div class="label">
                <span class="label-text text-secondary/60">Status *</span>
              </div>
              <select #statusSelect="ngModel" required id="statusSelect" name="statusSelect" [(ngModel)]="status" class="select w-full">
                  <option disabled value="null">Escolha um status</option>
                  <option value="PE">Pendente</option>
                  <option value="PA">Pago</option>
                  <option value="CA">Cancelado</option>
              </select>
              @if(statusSelect.invalid && statusSelect.touched){
                <p class="text-error">O status é obrigatório!</p>
              }
            </label>
  
          </div>
  
          <div class="flex flex-col min-[380px]:flex-row gap-2">
            <label class="form-control w-full mb-2">
              <div class="label">
                <span class="label-text text-secondary/60">Valor *</span>
              </div>
              <input #valueInput="ngModel" [(ngModel)]="value" name="valueInput" (input)="formatValue($event)" pattern="^\d{1,3}(\.\d{3})*,\d{2}$" placeholder="Ex: 1220" required class="input w-full" />
              @if(valueInput.invalid && valueInput.touched){
                <p class="text-error">O valor é obrigatório!</p>
              }
            </label>
            <label class="form-control w-full mb-2">
              <div class="label">
                <span class="label-text text-secondary/60">Descrição *</span>
              </div>
              <input #descriptionInput="ngModel" maxlength="512" [(ngModel)]="description" name="billDescriptionInput" type="text" required placeholder="Ex: Pagamento de salário" class="input w-full" />
              @if(descriptionInput.invalid && descriptionInput.touched){
                <p class="text-error">A descrição é obrigatória!</p>
              }
            </label>
          </div>
  
          <button type="button" (click)="showFields()" class="btn btn-ghost w-fit hover:text-primary self-center sm:self-end">
            <p class="transition-all">Campos opcionais</p>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" [ngClass]="fieldsVisible ? 'rotate-180' : 'rotate-0'" class="size-5 transition-all">
              <path fill-rule="evenodd" d="M9.47 6.47a.75.75 0 0 1 1.06 0l4.25 4.25a.75.75 0 1 1-1.06 1.06L10 8.06l-3.72 3.72a.75.75 0 0 1-1.06-1.06l4.25-4.25Z" clip-rule="evenodd" />
            </svg>                    
          </button>
  
          <div [ngClass]="fieldsVisible ? 'max-h-screen' : 'max-h-0'" class="flex flex-col transition-all h-full overflow-clip">
            <label class="form-control w-full mb-2">
              <div class="label">
                <span class="label-text text-secondary/60">Observação</span>
              </div>
              <input [(ngModel)]="observation" placeholder="Ex: Pagamento adiantado" name="observationInput" type="text" class="input w-full" />
            </label>
  
            <div class="flex flex-col sm:flex-row gap-2 items-end mb-2">
              <label for="lawsuitSelect" class="form-control w-full">
                <div class="label">
                  <span class="label-text text-secondary/60">Processo Relacionado</span>
                </div>
                <select id="lawsuitSelect" name="lawsuitSelect" [(ngModel)]="lawsuit" class="select w-full">
                  <option value="null">Nenhum</option>
                    @if (lawsuits$ | async; as lawsuits){
                      @for (lawsuit of lawsuits.results; track lawsuit.id){
                        <option value="{{lawsuit.lawops_lawsuit.id}}">{{lawsuit.lawops_lawsuit.cnj_number}}</option> 
                      }
                    }
                </select>
              </label>
              <div class="flex items-end w-full">
                <label for="categorySelect" class="form-control w-full min-w-10">
                  <div class="label">
                    <span class="label-text text-secondary/60">Categoria</span>
                  </div>
                  <select id="categorySelect" name="categorySelect" [(ngModel)]="category" class="select w-full">
                    <option [ngValue]="null">Nenhuma</option>
                    @if(categories$ | async; as categories){
                      @for(category of categories.results; track category.id){
                        <option value="{{category.id}}">{{category.name}}</option>
                      }
                    } @else {
                      <option>Nada aqui</option>
                    } 
                  </select>
                </label>
                <button type="button" class="btn btn-primary" (click)="openCategoryForm()">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                  </svg>                    
                </button>
              </div>
              
            </div>     
            <div class="flex flex-col sm:flex-row gap-2">
              <label class="form-control w-full mb-2">
                <div class="label">
                  <span class="label-text text-secondary/60">Data do pagamento</span>
                </div>
                <input [(ngModel)]="payment_date" name="paymentDateSelect" type="date" class="input w-full" />
              </label>
              <label class="form-control w-full mb-2">
                <div class="label">
                  <span class="label-text text-secondary/60">Data de vencimento</span>
                </div>
                <input [(ngModel)]="due_date" name="dueDateSelect" type="date" class="input w-full" />
              </label>
            </div>
          </div>
            @if(financeService.billSubmit){
              <span class="loading min-h-10 loading-spinner self-center mt-4 bg-primary loading-lg"></span>
            } @else {
              <button class="btn btn-primary max-w-28 self-center mt-4" [disabled]="billModalForm.invalid">Cadastrar</button>
            }  
        </form>
    </div>
    <form (click)="closeBillForm()" (click)="resetForm(billModalForm)" method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
  </dialog>
  
  
  <dialog [ngClass]="categoryForm ? 'modal-open' : ''" class="modal absolute top-0 bottom-0 right-0 left-0 modal-bottom w-full h-full z-50 sm:modal-middle">
    <div class="modal-box p-4 max-w-4xl w-full bg-neutral">
        <form method="dialog">
            <button (click)="closeCategoryForm()" (click)="resetForm(categoryModalForm)" class="btn btn-sm btn-circle text-error btn-ghost absolute right-2 z-50 top-2">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6 text-error">
                    <path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                </svg>                                  
            </button>
        </form>
        <div class="card">
            <div class="card-body w-full gap-0 p-0">
                <h2 class="card-title text-center self-center mb-4">Criar categoria</h2>
                <form #categoryModalForm="ngForm" (ngSubmit)="addCategory(categoryModalForm)" class="flex flex-col gap-2">
                    <label class="form-control w-full mb-2">
                      <div class="label">
                        <span class="label-text text-secondary/60">Nome *</span>
                      </div>
                      <input #categoryNameInput="ngModel" maxlength="255" [(ngModel)]="categoryName" name="categoryNameInput" type="text" required placeholder="Ex: Conta de luz" class="input w-full" />
                      @if(categoryNameInput.invalid && categoryNameInput.touched){
                        <p class="text-error">O nome é obrigatório!</p>
                      }
                    </label>                 
                    <label class="form-control w-full mb-2">
                      <div class="label">
                        <span class="label-text text-secondary/60">Descrição</span>
                      </div>
                      <input #categoryDescriptionInput="ngModel" [(ngModel)]="categoryDescription" name="categoryDescriptionInput" placeholder="Ex: Pagamento mensal da conta de eletricidade" type="text" class="input w-full" />
                    </label>                     
                    @if(financeService.categorySubmit){
                        <span class="loading min-h-10 loading-spinner self-center mt-4 bg-primary loading-lg"></span>
                    } @else {
                        <button class="btn btn-primary max-w-28 self-center mt-4" [disabled]="categoryModalForm.invalid">Cadastrar</button>
                    }
                
                </form>
            </div>
        </div>
    </div>
    <form (click)="closeCategoryForm()" (click)="resetForm(categoryModalForm)"  method="dialog" class="modal-backdrop">
        <button>close</button>
    </form>
  </dialog>
}